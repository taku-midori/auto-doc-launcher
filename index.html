<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8" />
  <title>書類作成中...</title>
  <script>
    // クエリパラメータ取得用の関数
    function getParam(name) {
      const url = new URL(window.location.href);
      return url.searchParams.get(name);
    }

    // GASのエンドポイントURL
    const gasUrl = "https://script.google.com/macros/s/AKfycbwIdanZMq2T_uJ08EsXeXgNG25S8OD7Sd4rvNO07xuQQVSQxgSxFZJdZKf1pnGDDgjC8w/exec";

    // 会議名とユーザーをURLから取得
    const meetingType = getParam("meetingType");
    const user = getParam("user");

    // GASへ送信（Slack通知 & Google Docs作成）
    if (meetingType && user) {
      fetch(`${gasUrl}?meetingType=${encodeURIComponent(meetingType)}&user=${encodeURIComponent(user)}`)
        .then(() => window.close())
        .catch(error => {
          document.body.innerHTML = `<p>⚠️ 書類の作成に失敗しました。<br>${error}</p>`;
        });
    } else {
      document.body.innerHTML = "<p>❗必要な情報（meetingType または user）がURLに含まれていません。</p>";
    }
  </script>
</head>
<body>
  <p>📝 議事録を作成中です。しばらくお待ちください...</p>
</body>
</html>
